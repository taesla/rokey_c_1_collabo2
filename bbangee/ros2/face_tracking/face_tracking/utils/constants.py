"""
Constants - Robot Specs, Camera Params, Safety Limits

로봇 및 카메라 관련 상수 정의
모든 단위는 명시적으로 표기 (mm, deg, sec)
"""

# ============================================
# Doosan M0609 Robot Specs
# ============================================

# 조인트 범위 (deg)
JOINT_LIMITS = {
    'J1': (-360.0, 360.0),
    'J2': (-95.0, 95.0),
    'J3': (-160.0, 160.0),
    'J4': (-360.0, 360.0),
    'J5': (-135.0, 135.0),
    'J6': (-360.0, 360.0),
}

# 조인트 최대 속도 (deg/s) - 로봇 스펙
JOINT_VEL_MAX = {
    'J1': 150.0,
    'J2': 150.0,
    'J3': 180.0,
    'J4': 225.0,
    'J5': 225.0,
    'J6': 225.0,
}

# 링크 길이 (mm)
LINK_LENGTHS = {
    'L1': 135.0,   # 베이스 높이
    'L2': 411.0,   # 어깨 링크
    'L3': 368.0,   # 팔꿈치 링크
    'L4': 113.0,   # 손목 링크
}

# TCP 오프셋 (mm) - RG2 그리퍼 + 카메라
TCP_OFFSET_Z = 228.6

# ============================================
# Safety Limits (mm)
# ============================================

SAFETY_LIMITS = {
    'r_min': 300.0,    # 최소 반경 - 로봇 몸통 충돌 방지
    'r_max': 850.0,    # 최대 반경 - 도달 한계
    'z_min': 150.0,    # 최소 높이 - 테이블 충돌 방지
    'z_max': 800.0,    # 최대 높이
}

# 안전 거리 (mm) - 얼굴과의 거리
SAFETY_DISTANCE = 650.0

# ============================================
# Camera Params (RealSense D435i)
# ============================================

CAMERA_PARAMS = {
    'frame_id': 'camera_color_optical_frame',
    'width': 640,
    'height': 480,
    'fps': 30,
}

# ============================================
# Control Params
# ============================================

# 제어 주파수 (Hz)
CONTROL_FREQUENCY = {
    'detection': 30,    # 얼굴 감지
    'tracking': 100,    # EKF 추적
    'control': 50,      # 로봇 제어
}

# 데드존 (deg) - 떨림 방지
DEAD_ZONE_DEG = 2.0

# 도착 판정 임계값 (deg)
ARRIVAL_THRESHOLD_DEG = 3.0

# ============================================
# Home / Start Positions (deg)
# ============================================

HOME_JOINTS = [0.0, 0.0, 90.0, 0.0, 90.0, 0.0]
START_JOINTS = [3.06, 2.84, 92.13, 86.07, -1.43, 8.33]

# ============================================
# EKF Params
# ============================================

EKF_PARAMS = {
    'dt': 0.033,           # 샘플링 시간 (30Hz)
    'process_noise': 0.1,  # 프로세스 노이즈
    'measure_noise_3d': 5.0,  # 측정 노이즈 (mm)
    'measure_noise_2d': 2.0,  # 측정 노이즈 (pixel)
}
